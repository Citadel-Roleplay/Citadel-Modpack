#On actions relating to relationships between characters

####################################
# NOTE
####################################
# All relations have these autogenerated, even if they're not explicitly written out here.
# The full list is:
# [relation]_quarterly_pulse
# on_set_relation_[relation]
# on_remove_relation_[relation]
# on_death_relation_[relation]
#
# The following two on_actions are scripted, rather than being called by code, so if you want one for them then it must be created and fired from the quarterly pulse.
# [relation]_status_changes
# [relation]_relation_changes
####################################

#According to PDX doc, ROOT is the DYING character
on_death_relation_agot_story_dragon = {
	effect = {
		if = {
			limit = {
				is_human = yes
				any_relation = {
					type = agot_story_dragon
					has_trait = dragon
					has_character_flag = owned_dragon
					NOR = {
						OR = {
							has_character_flag = in_dragonpit
							has_variable = travelling_from_pit
						}
						any_relation = {
							type = agot_dragon
						}
					}
				}
			}
			save_scope_as = dead_rider
			every_relation = {
				type = agot_story_dragon
				limit = {
					has_trait = dragon
					has_character_flag = owned_dragon
					NOR = {
						OR = {
							has_character_flag = in_dragonpit
							has_variable = travelling_from_pit
						}
						any_relation = {
							type = agot_dragon
						}
					}
				}
				agot_calculate_and_set_dragon_wild_status_effect = yes
			}
		}
	}
}

on_set_relation_agot_story_dragon = {}

on_remove_relation_agot_story_dragon = {}


