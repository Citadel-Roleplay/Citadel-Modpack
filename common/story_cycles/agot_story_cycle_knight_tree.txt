agot_knight_tree_teacher = { # Contains: this_teacher, student_container
	on_setup = {
		title:c_ruins.holder = {
			var:knight_teacher ?= { save_scope_as = knight_teacher }
			remove_variable = knight_teacher
		}
		set_variable = {
			name = this_teacher
			value = scope:knight_teacher
		}
	}
	on_end = {}
	on_owner_death = {}
}

agot_knight_tree_structure = { # Contains: knight_tree_founder, knight_tree_gui, teacher_story_container
	on_setup = {}
	on_end = {}
	on_owner_death = {}
	effect_group = {
		years = 1
		triggered_effect = {
			trigger = {
				var:knight_tree_founder ?= { is_alive = no }
				any_in_list = {
					variable = teacher_story_container
					count = all
					var:this_teacher ?= { is_alive = no }
					any_in_list = {
						variable = student_container
						count = all
						is_alive = no
					}
				}
			}
			effect = {
				every_in_list = {
					variable = teacher_story_container
					end_story = yes
				}

				change_global_variable = {
					name = knight_trees_destroyed
					add = 1
				}

				remove_list_global_variable = {
					name = known_knight_trees
					target = this
				}

				debug_log = "AGOTKT: A knight tree was removed on:"
				debug_log_date = yes
				debug_log_scopes = yes

				end_story = yes
			}
		}
	}
}
