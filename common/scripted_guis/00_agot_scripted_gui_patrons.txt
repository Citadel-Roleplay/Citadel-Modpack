## By Eskarina


patron_tooltip_god_name = {
	is_shown = {
		AND = {
			has_variable = patron_god
		}
	}

	is_valid = {

	}
}

choose_patron_generic = {
	saved_scopes = {
		patron_name
	}

	is_shown = {

	}

	is_valid = {
		piety >= minor_piety_value
		var:selected_faith = faith
	}

	effect = {
		parse_patron_name_flag_complex = { PATRON = scope:patron_name APPLY = agot_set_patron_effect }
	}
}

get_patron_god_list = {
	is_shown = {

	}

	is_valid = {

	}

	# possible issue: if the player changes religion while the patron god screen is open, they can pick a patron from their previous
	# religion post-conversion and keep it

	effect = {
		clear_variable_list = patron_gods
		if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = faith_of_the_seven_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_father
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_mother
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_warrior
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_smith
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_crone
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_stranger
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = faith_of_eight_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_father
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_mother
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_warrior
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_smith
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_crone
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_stranger
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:drownedgod
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = baelorist_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_father
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_mother
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_warrior
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_smith
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_crone
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_stranger
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:baelor
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = faith_of_the_seven_weirwood_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_father
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_mother
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_warrior
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_smith
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_crone
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_stranger
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:weirwood
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = faith_of_the_seven_qarlon_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_father
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_mother
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_warrior
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_smith
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_crone
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_stranger
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:qarlon
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = summer_gods_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:itaya
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:qunda
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:tolaq
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:dhosu
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:qhubar
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:chatana
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:hulabhar
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:xholthar
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:anayana
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:qoanasa
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = yiti_imperial_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:pearl_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:jade_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:tourmaline_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:onyx_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:topaz_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:opal_emperor
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:amethyst_empress
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = braavosi_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:moon_pale_maiden
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:merling_king
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:lion_of_night
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:father_of_waters
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = volantene_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:semosh_and_selloso
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:pantera
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:lion_of_night
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:aquan
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = lorath_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:hooded_wayfarer
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:bakkalon
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_pattern
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:father_of_waters
			}
		}
		else_if = {
			limit = {
				scope:faith = { has_doctrine_parameter = tyroshi_patrons }
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:semosh_and_selloso
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:trios
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:the_pattern
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:drunken_god
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = lyseni_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:weeping_lady
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:pantera
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:yyndros
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:bakkalon
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:saagael
			}
		}
		else_if = {
			limit = {
				scope:faith = {
					has_doctrine_parameter = myrish_patrons
				}
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:aquan
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:gelenei
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:hooded_wayfarer
			}
			add_to_variable_list = {
				name = patron_gods
				target = flag:silent_god
			}
		}
	}
}

clear_patron_god_list = {
	is_shown = {

	}

	is_valid = {

	}

	effect = {
		clear_variable_list = patron_gods
	}
}

religion_has_patron_gods = {
	is_shown = {
		agot_faith_has_patron_gods = yes
	}
}

faith_switch_effect = {
	scope = character
	saved_scopes = { faith }
	effect = {
		if = {
			limit = { NOT = { var:selected_faith ?= scope:faith } }
			set_variable = {
				name = selected_faith
				value = scope:faith
			}
		}
	}
}

has_this_patron_god = {
	is_valid = {
		var:patron_god ?= scope:patron_name
	}
}