agot_coronation_dread = {
	scope:potential_supporter = {
		add = {
			add = dread
			multiply = 1.0
		}
	}
}

agot_coronation_guest_total_value = {
	value = 0
	scope:activity = {
		every_attending_character = {
			limit = {
				is_landed = yes
				is_independent_ruler = no
				highest_held_title_tier >= tier_county
				has_character_flag = paid_homage
			}
			add = 1
		}
	}
}

agot_coronation_homage_legitimacy_value = {
	value = agot_coronation_guest_total_value
	add = {
		value = 0
		scope:activity = {
			every_attending_character = {
				limit = {
					scope:activity.special_guest:coronation_target ?= {
						is_liege_or_above_of = prev
					}
					highest_held_title_tier >= tier_county
					has_character_flag = refused_to_bend_knee
				}
				subtract = 1
			}
		}
	}
	if = {
		limit = {
			scope:activity = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_grandiose
				}
			}
		}
		divide = 3
	}
	if = {
		limit = {
			scope:activity = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_impressive
				}
			}
		}
		divide = 4
	}
	if = {
		limit = {
			scope:activity = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_appropriate
				}
			}
		}
		divide = 5
	}
	if = {
		limit = {
			scope:activity = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_humble
				}
			}
		}
		divide = 6
	}
	min = 0
	max = 275
}

agot_coronation_homage_prestige_value = {
	value = agot_coronation_guest_total_value
	add = {
		value = 0
		scope:activity = {
			every_attending_character = {
				limit = {
					scope:activity.special_guest:coronation_target ?= {
						is_liege_or_above_of = prev
					}
					highest_held_title_tier >= tier_county
					has_character_flag = refused_to_bend_knee
				}
				subtract = 1
			}
		}
	}
}