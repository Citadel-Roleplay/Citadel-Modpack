asoiaf_reforge_ice_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_smith.dds"
	}
	decision_group_type = artifact
	desc = asoiaf_reforge_ice_desc
	selection_tooltip = asoiaf_reforge_ice_selection_tooltip
	
	sort_order = 100
	ai_check_interval = 3
	
	cost = {
		prestige = { value = 750 }
		gold = { value = 1000 }
	}
	
	is_shown = {
		is_human = yes
		root = { any_character_artifact = { has_variable = asoiaf_is_ice } }
		OR = {
			root.dynasty = dynasty:dynn_Lannister
			root.house = house:house_BaratheonKL
		}
	}
	
	is_valid = {
		is_incapable = no
		custom_tooltip = {
			text = asoiaf_has_ice_tooltip
			root = { any_character_artifact = { has_variable = asoiaf_is_ice } }
		}
		OR = {
			root.dynasty = dynasty:dynn_Lannister
			root.house = house:house_BaratheonKL
		}
		#employs_court_position = court_smith_court_position
		custom_tooltip = {
			text = asoiaf_has_master_court_smith_tooltip
			any_court_position_holder = {
				type = court_smith_court_position
				AND = {
					OR = {
						faith = { has_doctrine_parameter = reforge_valyrian_steel }
						has_character_flag = can_reforge_valyrian_steel
					}
					aptitude = {
						court_position = court_smith_court_position
						value >= 4
					}
				}
			}
		}
	}

	#ai_potential = {
	#	trigger_if = {
	#		OR = {
	#			this = character:Lannister_1 #this is AI Tywin
	#			this = character:Baratheon_5 #this is AI Joffrey
	#		}
	#	}
	#}
	ai_will_do = {
		base = -50
		modifier = {
			add = 1000
			OR = {
				this = character:Lannister_1 #this is AI Tywin
				this = { has_inactive_trait = asoiaf_Lannister_1_trait }
			}
		}
		modifier = {
			add = 1000
			OR = {
				this = character:Baratheon_5 #this is AI Joffrey
				this = { has_inactive_trait = asoiaf_Baratheon_5_trait }
			}
		}
	}
	
	effect = {
		custom_tooltip = { #DESTROY ICE
			text = asoiaf_reforge_ice_effect_tooltip_1
			every_character_artifact = {
				limit = { has_variable = asoiaf_is_ice }
				save_scope_as = this_artifact
			}
			destroy_artifact = scope:this_artifact
		}
		hidden_effect = {
			root = {
				every_courtier = {
					limit = { has_court_position = court_smith_court_position }
					save_scope_as = asoiaf_master_smith
				}
			}
		}
		custom_tooltip = { #CREATE OATHKEEPER AND WIDOW'S WAIL
			text = asoiaf_reforge_ice_effect_tooltip_2
			asoiaf_create_artifact_oathkeeper_effect_decision = { OWNER = this CREATOR = scope:asoiaf_master_smith }
			asoiaf_create_artifact_widows_wail_effect_decision = { OWNER = this CREATOR = scope:asoiaf_master_smith }
		}
		custom_tooltip = { #START FEUD WITH STARKS
			text = asoiaf_reforge_ice_effect_tooltip_3
			if = {
				limit = {
					exists = character:Stark_12.house.house_head
				}
				character:Stark_12.house.house_head ?= {
					#set_relation_grudge = { reason = asoiaf_reforge_ice_grudge_desc target = root }
					house_feud_start_effect = {
						# Feuding House Head
						ACTOR = character:Stark_12.house.house_head
						# Target House Head
						TARGET = root
						# Feud Reason
						REASON = inherited_rivalry
						# House Member attacker if relevant 
						ATTACKER = root
						# House Member victim if relevant
						VICTIM = character:Stark_12.house.house_head
					}
				}
				character:Stark_12.house = {
					every_house_member = {
						add_opinion = {
							modifier = hate_opinion
							target = root
							opinion = -50
						}
					}
				}
			}
		}
		hidden_effect = {
			root = {
				every_courtier = {
					limit = { has_court_position = court_smith_court_position }
					add_gold = 500
				}
			}
		}
	}
}