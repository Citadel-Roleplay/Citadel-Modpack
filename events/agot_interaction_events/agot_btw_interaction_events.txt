namespace = agot_btw_interaction_events

#Wildling called neighbours to help fight the interlopers (called from character interaction)
agot_btw_interaction_events.0001 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0001.opening
	}
	desc = agot_btw_interaction_events.0001.desc

	sender = {
		character = scope:wildling_caller
		animation = worry
	}

	option = { #I will join in a united fight against the kneelers
		name = agot_btw_interaction_events.0001.a
		save_scope_as = wildling_ally
		scope:wildling_caller = {
			every_character_war = {
				limit = {
					scope:wildling_caller = {
						is_at_war_as_defender = yes
					}
					primary_defender = scope:wildling_caller
					primary_attacker = {
						NOT = {
							any_character_struggle = {
								involvement = involved
							}
						}
					}
				}
				add_defender = scope:wildling_ally
			}
			trigger_event = {
				id = agot_btw_interaction_events.0002 days = { 1 5 }
			}
		}
		ai_chance = {
			base = 1
			modifier = {
				add = 10
				culture = scope:wildling_caller.culture
			}
			modifier = {
				add = 15
				opinion = {
					target = scope:wildling_caller
					value >= 10
				}
			}
			modifier = {
				add = 5
				opinion = {
					target = scope:wildling_caller
					value >= 20
				}
			}
			modifier = {
				add = 5
				opinion = {
					target = scope:wildling_caller
					value >= 30
				}
			}
			modifier = {
				add = 20
				any_spouse = {
					dynasty = scope:wildling_caller.dynasty
				}
			}
			modifier = {
				add = -1000
				existing_feud_against_target_trigger = { TARGET = scope:wildling_ally }
			}
			modifier = {
				add = 1000
				has_trait = just
			}
			modifier = {
				add = -100
				has_relation_rival = scope:wildling_ally
			}
			modifier = {
				add = 100
				OR = {
					has_relation_best_friend = scope:wildling_ally
					has_relation_friend = scope:wildling_ally
					has_relation_lover = scope:wildling_ally
					has_relation_soulmate = scope:wildling_ally
				}
			}
			modifier = {
				add = 100
				ai_has_warlike_personality = yes
			}
			ai_value_modifier = {
				ai_greed = 0.2
				ai_rationality = 10
				ai_boldness = 0.7
				ai_honor = 10
				ai_zeal = 1
				ai_compassion = 10
			}
		}
	}
	option = { #i will join.... for a "gift"
		name = agot_btw_interaction_events.0001.b
		save_scope_as = wildling_greedy_ally
		scope:wildling_caller = {
			trigger_event = { id = agot_btw_interaction_events.0003 days = { 1 5 } }
		}
		ai_chance = {
			base = 1
			modifier = {
				add = 10
				culture = scope:wildling_caller.culture
			}
			modifier = {
				add = -15
				opinion = {
					target = scope:wildling_caller
					value >= 10
				}
			}
			modifier = {
				add = -5
				opinion = {
					target = scope:wildling_caller
					value >= 20
				}
			}
			modifier = {
				add = -5
				opinion = {
					target = scope:wildling_caller
					value >= 30
				}
			}
			modifier = {
				add = -20
				any_spouse = {
					dynasty = scope:wildling_caller.dynasty
				}
			}
			modifier = {
				add = -1000
				existing_feud_against_target_trigger = { TARGET = scope:wildling_ally }
			}
			modifier = {
				add = -100
				has_relation_rival = scope:wildling_ally
			}
			modifier = {
				add = -100
				OR = {
					has_relation_best_friend = scope:wildling_ally
					has_relation_friend = scope:wildling_ally
					has_relation_lover = scope:wildling_ally
					has_relation_soulmate = scope:wildling_ally
				}
			}
			modifier = {
				add = 50
				has_trait = greedy
			}
			modifier = {
				add = 10
				has_trait = cynical
			}
			modifier = {
				add = 15
				has_trait = fickle
			}
			modifier = {
				add = 25
				has_trait = deceitful
			}
			modifier = {
				add = 10
				has_trait = callous
			}
			modifier = {
				add = -1000
				has_trait = just
			}
			modifier = {
				add = 5
				ai_has_warlike_personality = yes
			}
			ai_value_modifier = {
				ai_greed = 10
				ai_rationality = 5
				ai_boldness = 0.4
				ai_honor = -15
				ai_zeal = 1
				ai_compassion = -5
			}
		}
	}
	option = { #no
		name = agot_btw_interaction_events.0001.c
		save_scope_as = wildling_war_denier #>:)
		scope:wildling_caller = {
			trigger_event = { id = agot_btw_interaction_events.0004 days = { 1 5 } }
		}

		ai_chance = {
			base = 1
			modifier = {
				add = 10
				culture = scope:wildling_caller.culture
			}
			modifier = {
				add = -1000
				has_trait = just
			}
			modifier = {
				add = -15
				opinion = {
					target = scope:wildling_caller
					value >= 10
				}
			}
			modifier = {
				add = -5
				opinion = {
					target = scope:wildling_caller
					value >= 20
				}
			}
			modifier = {
				add = -5
				opinion = {
					target = scope:wildling_caller
					value >= 30
				}
			}
			modifier = {
				add = -20
				any_spouse = {
					dynasty = scope:wildling_caller.dynasty
				}
			}
			modifier = {
				add = -1000
				existing_feud_against_target_trigger = { TARGET = scope:wildling_ally }
			}
			modifier = {
				add = -100
				has_relation_rival = scope:wildling_ally
			}
			modifier = {
				add = -100
				OR = {
					has_relation_best_friend = scope:wildling_ally
					has_relation_friend = scope:wildling_ally
					has_relation_lover = scope:wildling_ally
					has_relation_soulmate = scope:wildling_ally
				}
			}
			modifier = {
				add = 100
				has_trait = greedy
			}
			modifier = {
				add = 100
				has_trait = craven
			}
			modifier = {
				add = 100
				OR = {
					has_trait = lunatic_1
					has_trait = lunatic_genetic
				}
			}
			modifier = {
				add = -100
				has_trait = intellect_good_3
			}
			modifier = {
				add = -50
				has_trait = intellect_good_2
			}
			modifier = {
				add = -25
				has_trait = intellect_good_1
			}
			modifier = {
				add = 100
				has_trait = intellect_bad_3
			}
			modifier = {
				add = 50
				has_trait = intellect_bad_2
			}
			modifier = {
				add = 25
				has_trait = intellect_bad_1
			}
			ai_value_modifier = {
				ai_greed = 1
				ai_rationality = -50
				ai_boldness = -50
				ai_honor = -100
				ai_zeal = -2
				ai_compassion = -50
			}
		}
	}
}

#wildling ruler accepted CTA
agot_btw_interaction_events.0002 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0002.opening
	}
	desc = agot_btw_interaction_events.0002.desc

	sender = {
		character = scope:wildling_ally
		animation = war_defender
	}

	#nice
	option = {
		name = agot_btw_interaction_events.0002.a
		root = {
			add_opinion = {
				target = scope:wildling_ally
				modifier = grateful_opinion
				opinion = 30
			}
		}
	}
}

#wildling ruler accepted CTA, for an price. Greedy bastard
agot_btw_interaction_events.0003 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0003.opening
	}
	desc = agot_btw_interaction_events.0003.desc

	sender = {
		character = scope:wildling_greedy_ally
		animation = personality_greedy
	}

	#accept his/hers 'request'
	option = {
		name = agot_btw_interaction_events.0003.a
		root = {
			add_opinion = {
				target = scope:wildling_greedy_ally
				modifier = insulted_opinion
			}
			pay_long_term_gold = {
				target = scope:wildling_greedy_ally
				gold = 100 #AGOT TODO SCALE BASED ON THE TIER, TURN INTO SCRIPT VALUE
			}
		}
		every_character_war = {
			limit = {
				root = {
					is_at_war_as_defender = yes
				}
				primary_defender = root
				primary_attacker = {
					NOT = {
						any_character_struggle = {
							involvement = involved
						}
					}
				}
			}
			add_defender = scope:wildling_greedy_ally
		}
	}
	#propose one of your family members as a price of joining
	option = {
		name = agot_btw_interaction_events.0003.b
		trigger = {
			exists = this.house
			this.house = {
				any_house_member = {
					NOR = {
						is_married = yes
						is_ruler = yes
					}
				}
			}
		}

		this.house = {
			random_house_member = {
				limit = {
					NOR = {
						is_married = yes
						is_ruler = yes
					}
				}
				save_scope_as = wildling_potential_house_hostage
			}
		}
		scope:wildling_greedy_ally = {
			trigger_event = {
				id = agot_btw_interaction_events.0005
				days = {3 5}
			}
		}
	}
	#Refuse ruler request
	option = {
		name = agot_btw_interaction_events.0003.c
		root = {
			progress_towards_rival_effect = {
				CHARACTER = scope:wildling_greedy_ally
				REASON = rival_troublesome_warrior #change to refusing to join in the wildling war
				OPINION = -40
			}
		}
	}
}

#wildling decided to ignore your call...
agot_btw_interaction_events.0004 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0004.opening
	}
	desc = agot_btw_interaction_events.0004.desc

	sender = {
		character = scope:wildling_war_denier
		animation = dismissal
	}

	option = {
		name = agot_btw_interaction_events.0004.a

		root = {
			progress_towards_rival_effect = {
				CHARACTER = scope:wildling_war_denier
				REASON = rival_troublesome_warrior #change to refusing to join in the wildling war
				OPINION = -70
			}
		}
	}
}

#wildling caller proposed one of his family members as payment to join
agot_btw_interaction_events.0005 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0005.opening
	}
	desc = agot_btw_interaction_events.0005.desc


	sender = {
		character = scope:wildling_caller
		animation = disapproval
	}

	option = { #accept
		name = agot_btw_interaction_events.0005.a
		imprison = {
			target = scope:wildling_potential_house_hostage
			type = house_arrest
		}
		every_character_war = {
			limit = {
				scope:wildling_caller = {
					is_at_war_as_defender = yes
				}
				primary_defender = scope:wildling_caller
				primary_attacker = {
					NOT = {
						any_character_struggle = {
							involvement = involved
						}
					}
				}
			}
			add_defender = root
		}
		scope:wildling_caller = {
			trigger_event = {
				id = agot_btw_interaction_events.0006
				days = { 3 5 }
			}
		}
	}

	option = { #lmao no
		name = agot_btw_interaction_events.0005.b

		scope:wildling_caller = {
			trigger_event = {
				id = agot_btw_interaction_events.0007
				days = { 3 5 }
			}
		}
	}
}

#Wildling caller learns of greedy ally joining
agot_btw_interaction_events.0006 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0006.opening
	}
	desc = agot_btw_interaction_events.0006.desc


	sender = {
		character = scope:wildling_greedy_ally
		animation = war_defender
	}


	option = { #good
		name = agot_btw_interaction_events.0006.a
	}
}

#Wildling caller learns of greedy ally rejecting offer 
agot_btw_interaction_events.0007 = {
	type = letter_event

	opening = {
		desc = agot_btw_interaction_events.0007.opening
	}
	desc = agot_btw_interaction_events.0007.desc


	sender = {
		character = scope:wildling_greedy_ally
		animation = disapproval
	}

	option = { #you shall pay for that
		name = agot_btw_interaction_events.0007.a
		progress_towards_rival_effect = {
			CHARACTER = scope:wildling_greedy_ally
			REASON = rival_troublesome_warrior #change to refusing to join in the wildling war
			OPINION = -40
		}
	}
}